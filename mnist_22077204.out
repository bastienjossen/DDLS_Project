Namespace(n=20, m=64, test_m=2000, f=0, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='36,23,40,42,14,20,34,29,32,24,40,39,33,43,36,24,36,23,40,32')
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_64_f_0_T_100_runs_5_alpha_0.5_Q
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [39.159929037094116, 34.06072449684143, 34.09758543968201, 34.14629912376404, 34.0572669506073]
results [[[77.85]
  [82.8 ]
  [85.3 ]
  [85.65]
  [83.6 ]
  [62.15]]

 [[76.  ]
  [84.05]
  [86.75]
  [87.25]
  [68.35]
  [85.15]]

 [[72.05]
  [76.95]
  [80.75]
  [82.45]
  [77.1 ]
  [82.3 ]]

 [[75.6 ]
  [80.  ]
  [83.85]
  [80.5 ]
  [37.4 ]
  [83.95]]

 [[77.75]
  [84.5 ]
  [85.15]
  [79.8 ]
  [83.25]
  [85.3 ]]]
Average accuracies for last run  [77.75 84.5  85.15 79.8  83.25 85.3 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [75.85 81.66 84.36 83.13 69.94 79.77]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=3, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='36,23,40,42,14,20,33,29,32,24,40,39,33,43,36,24,36')
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_64_f_3_T_100_runs_5_alpha_0.5_H
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [31.720129013061523, 33.04787611961365, 31.386754512786865, 31.287671327590942, 31.266295194625854]
results [[[79.4 ]
  [86.95]
  [83.55]
  [81.  ]
  [87.95]
  [76.35]]

 [[75.1 ]
  [79.9 ]
  [82.1 ]
  [81.7 ]
  [82.2 ]
  [82.65]]

 [[79.1 ]
  [85.5 ]
  [81.7 ]
  [78.6 ]
  [81.65]
  [71.1 ]]

 [[75.  ]
  [77.85]
  [78.8 ]
  [83.15]
  [85.5 ]
  [86.2 ]]

 [[69.9 ]
  [76.  ]
  [79.  ]
  [76.35]
  [65.35]
  [42.05]]]
Average accuracies for last run  [69.9  76.   79.   76.35 65.35 42.05]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [75.7  81.24 81.03 80.16 80.53 71.67]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=6, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='36,22,40,42,13,19,33,29,32,24,41,40,33,44')
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_64_f_6_T_100_runs_5_alpha_0.5_z
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [27.84137773513794, 27.53653120994568, 27.494382858276367, 27.376577615737915, 27.5188148021698]
results [[[77.85]
  [86.45]
  [88.6 ]
  [79.1 ]
  [89.35]
  [87.85]]

 [[77.95]
  [78.8 ]
  [84.5 ]
  [85.6 ]
  [86.6 ]
  [57.15]]

 [[78.6 ]
  [83.15]
  [79.8 ]
  [84.25]
  [69.4 ]
  [83.15]]

 [[71.85]
  [76.6 ]
  [82.05]
  [84.5 ]
  [77.  ]
  [45.9 ]]

 [[74.3 ]
  [77.55]
  [79.6 ]
  [73.15]
  [84.7 ]
  [73.9 ]]]
Average accuracies for last run  [74.3  77.55 79.6  73.15 84.7  73.9 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [76.11 80.51 82.91 81.32 81.41 69.59]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=9, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='38,24,42,44,14,20,36,31,34,26,43')
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_64_f_9_T_100_runs_5_alpha_0.5_q
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [23.409247636795044, 24.6530442237854, 23.024025678634644, 23.10428261756897, 23.07078456878662]
results [[[75.85]
  [83.4 ]
  [85.25]
  [81.15]
  [85.25]
  [69.05]]

 [[70.2 ]
  [81.95]
  [85.3 ]
  [87.1 ]
  [76.6 ]
  [66.95]]

 [[73.7 ]
  [80.8 ]
  [88.35]
  [79.8 ]
  [88.7 ]
  [84.3 ]]

 [[75.8 ]
  [80.85]
  [84.85]
  [86.75]
  [82.05]
  [65.75]]

 [[76.85]
  [81.15]
  [80.75]
  [76.75]
  [78.25]
  [72.55]]]
Average accuracies for last run  [76.85 81.15 80.75 76.75 78.25 72.55]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [74.48 81.63 84.9  82.31 82.17 71.72]
F1 score [0.8 1.  1.  1.  1.  1. ]
Namespace(n=20, m=64, test_m=2000, f=0, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='70,43,78,83,27,39,67,59,65,48,82,80,66,87,74,48,72,46,82,64')
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_64_f_0_T_100_runs_5_alpha_0.5_t
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [45.38039970397949, 44.8343939781189, 44.84646797180176, 44.84694695472717, 44.89303112030029]
results [[[83.1 ]
  [74.15]
  [87.3 ]
  [84.7 ]
  [84.6 ]
  [42.85]]

 [[84.3 ]
  [88.2 ]
  [90.1 ]
  [83.4 ]
  [78.85]
  [63.6 ]]

 [[79.55]
  [81.9 ]
  [85.6 ]
  [83.35]
  [72.  ]
  [80.95]]

 [[85.  ]
  [87.95]
  [87.9 ]
  [84.95]
  [85.75]
  [81.4 ]]

 [[80.8 ]
  [86.1 ]
  [87.15]
  [65.  ]
  [60.95]
  [86.25]]]
Average accuracies for last run  [80.8  86.1  87.15 65.   60.95 86.25]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [82.55 83.66 87.61 80.28 76.43 71.01]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=3, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='70,43,79,83,27,39,67,58,65,48,82,80,66,87,74,48,72')
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_64_f_3_T_100_runs_5_alpha_0.5_a
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [39.4909462928772, 39.197168827056885, 39.26355004310608, 39.143951416015625, 39.24815845489502]
results [[[84.15]
  [80.2 ]
  [84.9 ]
  [70.65]
  [67.25]
  [82.3 ]]

 [[74.35]
  [82.15]
  [84.3 ]
  [84.95]
  [83.35]
  [78.8 ]]

 [[82.55]
  [84.8 ]
  [86.  ]
  [85.3 ]
  [82.45]
  [82.95]]

 [[81.8 ]
  [84.25]
  [74.7 ]
  [85.3 ]
  [39.15]
  [45.05]]

 [[80.05]
  [76.15]
  [85.8 ]
  [83.35]
  [88.4 ]
  [59.25]]]
Average accuracies for last run  [80.05 76.15 85.8  83.35 88.4  59.25]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [80.58 81.51 83.14 81.91 72.12 69.67]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=6, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='70,44,79,83,27,39,67,59,65,48,82,80,66,87')
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_64_f_6_T_100_runs_5_alpha_0.5_G
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [34.805782079696655, 34.24214792251587, 34.30250573158264, 34.229928970336914, 34.27459955215454]
results [[[83.4 ]
  [85.5 ]
  [80.55]
  [73.5 ]
  [70.7 ]
  [77.4 ]]

 [[59.8 ]
  [75.1 ]
  [87.5 ]
  [83.2 ]
  [86.65]
  [52.9 ]]

 [[77.15]
  [82.4 ]
  [81.1 ]
  [69.75]
  [83.15]
  [79.85]]

 [[84.25]
  [84.9 ]
  [88.45]
  [79.15]
  [47.8 ]
  [82.5 ]]

 [[76.9 ]
  [80.35]
  [71.75]
  [80.55]
  [59.3 ]
  [84.65]]]
Average accuracies for last run  [76.9  80.35 71.75 80.55 59.3  84.65]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [76.3  81.65 81.87 77.23 69.52 75.46]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=9, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='74,47,84,88,29,42,71,62,69,51,87')
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_64_f_9_T_100_runs_5_alpha_0.5_U
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [29.524763345718384, 29.08407759666443, 29.24522304534912, 29.160807609558105, 29.072996139526367]
results [[[81.45]
  [87.7 ]
  [75.05]
  [74.05]
  [66.7 ]
  [55.  ]]

 [[81.4 ]
  [85.6 ]
  [66.35]
  [84.95]
  [70.15]
  [67.2 ]]

 [[70.55]
  [81.2 ]
  [82.75]
  [72.1 ]
  [82.5 ]
  [43.65]]

 [[84.05]
  [87.8 ]
  [89.2 ]
  [87.55]
  [82.45]
  [78.65]]

 [[82.4 ]
  [87.55]
  [78.35]
  [88.4 ]
  [85.3 ]
  [86.15]]]
Average accuracies for last run  [82.4  87.55 78.35 88.4  85.3  86.15]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [79.97 85.97 78.34 81.41 77.42 66.13]
F1 score [1. 1. 1. 1. 1. 1.]
