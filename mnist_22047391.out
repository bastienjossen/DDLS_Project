Namespace(n=20, m=32, test_m=2000, f=0, T=100, heterogeneity='homogeneous', alpha=1, attack='NS', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=2, nb_classes=10, algo='IPGD', eval_every=10)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1, 'attack': 'NS', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 2, 'eval_every': 10, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/homogeneous/NS/n_20_m_32_f_0_T_100_runs_5_alpha_1
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [120.85147309303284, 116.67403411865234, 116.72454595565796, 116.79773259162903, 116.71768736839294]
results [[[58.1  68.45]
  [86.35 90.  ]
  [88.15 91.5 ]
  [89.1  92.1 ]
  [89.95 91.95]
  [90.   92.35]]

 [[64.75 65.75]
  [85.15 87.5 ]
  [88.4  89.75]
  [90.05 90.45]
  [90.85 90.7 ]
  [91.35 90.5 ]]

 [[61.55 71.8 ]
  [85.85 89.85]
  [88.6  91.15]
  [90.2  91.65]
  [90.85 92.65]
  [91.95 92.75]]

 [[60.55 72.25]
  [84.55 89.15]
  [87.65 90.15]
  [88.55 90.85]
  [88.2  90.9 ]
  [89.9  91.65]]

 [[57.55 67.45]
  [86.15 88.5 ]
  [88.8  89.55]
  [90.05 90.3 ]
  [90.75 90.6 ]
  [90.55 90.9 ]]]
Average accuracies for last run  [62.5   87.325 89.175 90.175 90.675 90.725]
f1 score for last run  [[1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]]
Average accuracies  [64.82  87.305 89.37  90.33  90.74  91.19 ]
F1 score [0.99964664 1.         1.         1.         1.         1.        ]
Namespace(n=20, m=32, test_m=2000, f=3, T=100, heterogeneity='homogeneous', alpha=1, attack='NS', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=2, nb_classes=10, algo='IPGD', eval_every=10)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1, 'attack': 'NS', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 2, 'eval_every': 10, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/homogeneous/NS/n_20_m_32_f_3_T_100_runs_5_alpha_1
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [104.33832335472107, 104.11278676986694, 104.1202495098114, 104.06430268287659, 104.02297353744507]
results [[[58.15 68.4 ]
  [84.85 88.45]
  [87.4  89.95]
  [87.8  90.75]
  [88.75 90.75]
  [88.3  90.8 ]]

 [[64.45 61.8 ]
  [83.3  86.35]
  [86.95 88.25]
  [88.45 89.  ]
  [82.1  89.2 ]
  [89.1  89.4 ]]

 [[61.65 72.1 ]
  [83.7  88.05]
  [86.85 89.  ]
  [88.   90.25]
  [89.5  90.35]
  [88.4  90.8 ]]

 [[60.55 72.3 ]
  [82.95 88.3 ]
  [86.65 89.8 ]
  [87.8  89.9 ]
  [83.15 90.05]
  [88.4  90.4 ]]

 [[57.55 67.8 ]
  [84.95 86.8 ]
  [87.8  88.55]
  [89.1  89.  ]
  [88.95 89.3 ]
  [89.35 88.95]]]
Average accuracies for last run  [62.675 85.875 88.175 89.05  89.125 89.15 ]
f1 score for last run  [[1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]]
Average accuracies  [64.475 85.77  88.12  89.005 88.21  89.39 ]
F1 score [0.99945946 1.         1.         1.         1.         1.        ]
Namespace(n=20, m=32, test_m=2000, f=6, T=100, heterogeneity='homogeneous', alpha=1, attack='NS', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=2, nb_classes=10, algo='IPGD', eval_every=10)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1, 'attack': 'NS', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 2, 'eval_every': 10, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/homogeneous/NS/n_20_m_32_f_6_T_100_runs_5_alpha_1
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [94.12517499923706, 93.67693424224854, 93.75821208953857, 94.00706791877747, 93.3994619846344]
results [[[57.75 66.65]
  [81.95 84.65]
  [84.65 87.35]
  [85.65 88.15]
  [86.6  89.25]
  [86.25 88.65]]

 [[65.   66.15]
  [79.25 83.35]
  [83.3  86.45]
  [86.7  87.45]
  [87.   88.  ]
  [86.75 87.75]]

 [[61.55 71.95]
  [79.75 85.7 ]
  [83.75 87.35]
  [85.65 88.15]
  [86.35 88.35]
  [86.4  88.05]]

 [[60.5  72.4 ]
  [79.1  85.4 ]
  [83.65 87.25]
  [84.9  88.  ]
  [85.7  87.85]
  [85.4  87.7 ]]

 [[57.6  67.4 ]
  [80.4  84.2 ]
  [85.8  87.05]
  [86.3  86.95]
  [87.7  87.2 ]
  [87.1  87.75]]]
Average accuracies for last run  [62.5   82.3   86.425 86.625 87.45  87.425]
f1 score for last run  [[1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]]
Average accuracies  [64.695 82.375 85.66  86.79  87.4   87.18 ]
F1 score [0.99965157 0.99979296 0.99979633 0.9997955  1.         1.        ]
Namespace(n=20, m=32, test_m=2000, f=9, T=100, heterogeneity='homogeneous', alpha=1, attack='NS', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=2, nb_classes=10, algo='IPGD', eval_every=10)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1, 'attack': 'NS', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 2, 'eval_every': 10, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/homogeneous/NS/n_20_m_32_f_9_T_100_runs_5_alpha_1
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [82.99855852127075, 82.29888677597046, 82.29624128341675, 82.64904475212097, 82.49512052536011]
results [[[58.45 68.5 ]
  [68.   75.8 ]
  [73.45 80.  ]
  [77.2  82.45]
  [78.9  82.8 ]
  [73.55 80.55]]

 [[64.2  62.25]
  [69.1  72.75]
  [72.3  78.25]
  [74.7  81.3 ]
  [73.75 82.  ]
  [73.95 79.6 ]]

 [[61.55 72.05]
  [67.2  79.7 ]
  [70.55 80.8 ]
  [72.75 82.6 ]
  [75.95 82.75]
  [75.5  80.75]]

 [[60.6  72.15]
  [68.95 77.9 ]
  [72.55 80.05]
  [75.05 82.35]
  [73.4  82.6 ]
  [73.55 80.2 ]]

 [[57.6  67.6 ]
  [62.75 76.4 ]
  [68.9  79.75]
  [74.6  82.2 ]
  [74.8  82.35]
  [75.15 81.05]]]
Average accuracies for last run  [62.6   69.575 74.325 78.4   78.575 78.1  ]
f1 score for last run  [[1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]]
Average accuracies  [64.495 71.855 75.66  78.52  78.93  77.385]
F1 score [0.99949239 0.99942393 0.99946762 0.99978308 0.99978678 1.        ]
Namespace(n=20, m=64, test_m=2000, f=0, T=100, heterogeneity='homogeneous', alpha=1, attack='NS', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=2, nb_classes=10, algo='IPGD', eval_every=10)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1, 'attack': 'NS', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 2, 'eval_every': 10, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/homogeneous/NS/n_20_m_64_f_0_T_100_runs_5_alpha_1
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [160.06011843681335, 160.0983328819275, 159.56032848358154, 159.61218810081482, 159.63267850875854]
results [[[73.55 78.45]
  [88.15 91.5 ]
  [90.95 93.2 ]
  [91.45 93.8 ]
  [91.65 94.4 ]
  [92.   94.8 ]]

 [[80.6  77.05]
  [88.9  91.1 ]
  [91.15 92.5 ]
  [91.85 93.6 ]
  [92.45 93.85]
  [92.6  94.2 ]]

 [[80.35 84.4 ]
  [89.25 89.95]
  [91.   91.65]
  [91.75 92.9 ]
  [91.9  92.85]
  [90.35 93.3 ]]

 [[74.55 80.05]
  [88.   92.  ]
  [90.95 94.15]
  [91.2  94.8 ]
  [91.85 95.1 ]
  [92.1  95.1 ]]

 [[75.7  83.05]
  [87.45 89.55]
  [89.75 91.35]
  [91.2  92.1 ]
  [92.1  92.6 ]
  [92.4  92.3 ]]]
Average accuracies for last run  [79.375 88.5   90.55  91.65  92.35  92.35 ]
f1 score for last run  [[1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]]
Average accuracies  [78.775 89.585 91.665 92.465 92.875 92.915]
F1 score [0.99951767 1.         1.         1.         1.         1.        ]
Namespace(n=20, m=64, test_m=2000, f=3, T=100, heterogeneity='homogeneous', alpha=1, attack='NS', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=2, nb_classes=10, algo='IPGD', eval_every=10)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1, 'attack': 'NS', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 2, 'eval_every': 10, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/homogeneous/NS/n_20_m_64_f_3_T_100_runs_5_alpha_1
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [145.78278017044067, 146.04584980010986, 145.89794206619263, 145.90430808067322, 145.93753290176392]
results [[[74.   78.8 ]
  [86.3  90.1 ]
  [89.4  92.15]
  [90.75 93.25]
  [90.85 93.25]
  [77.6  93.35]]

 [[82.15 78.2 ]
  [87.5  90.25]
  [90.05 92.15]
  [91.   93.2 ]
  [91.35 93.6 ]
  [92.25 93.1 ]]

 [[79.7  83.65]
  [88.05 89.1 ]
  [90.45 91.15]
  [91.   91.9 ]
  [91.7  92.05]
  [91.3  92.5 ]]

 [[73.4  79.2 ]
  [86.75 91.4 ]
  [89.65 93.25]
  [90.7  93.75]
  [91.1  93.95]
  [89.45 94.2 ]]

 [[75.9  83.05]
  [86.4  88.35]
  [88.55 90.4 ]
  [89.9  91.2 ]
  [90.35 91.1 ]
  [89.6  91.35]]]
Average accuracies for last run  [79.475 87.375 89.475 90.55  90.725 90.475]
f1 score for last run  [[1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]]
Average accuracies  [78.805 88.42  90.72  91.665 91.93  90.47 ]
F1 score [0.99951767 1.         1.         1.         1.         1.        ]
Namespace(n=20, m=64, test_m=2000, f=6, T=100, heterogeneity='homogeneous', alpha=1, attack='NS', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=2, nb_classes=10, algo='IPGD', eval_every=10)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1, 'attack': 'NS', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 2, 'eval_every': 10, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/homogeneous/NS/n_20_m_64_f_6_T_100_runs_5_alpha_1
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [125.75851511955261, 125.03499364852905, 125.07141017913818, 124.92820239067078, 124.84817361831665]
results [[[73.9  78.95]
  [84.   87.6 ]
  [87.5  90.15]
  [88.4  90.95]
  [82.7  91.1 ]
  [88.3  91.55]]

 [[81.15 77.4 ]
  [86.5  89.15]
  [89.   90.35]
  [89.7  91.45]
  [90.35 91.55]
  [90.65 91.6 ]]

 [[80.1  84.8 ]
  [85.95 88.05]
  [88.5  89.6 ]
  [89.35 90.5 ]
  [90.05 90.5 ]
  [89.95 91.05]]

 [[73.9  79.95]
  [83.85 88.4 ]
  [87.95 90.55]
  [89.3  91.7 ]
  [89.4  92.  ]
  [88.75 92.2 ]]

 [[75.95 82.75]
  [84.8  87.9 ]
  [87.75 88.7 ]
  [88.3  89.  ]
  [89.1  89.2 ]
  [89.35 89.5 ]]]
Average accuracies for last run  [79.35  86.35  88.225 88.65  89.15  89.425]
f1 score for last run  [[1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]]
Average accuracies  [78.885 86.62  89.005 89.865 89.595 90.29 ]
F1 score [0.99951767 1.         1.         1.         1.         1.        ]
Namespace(n=20, m=64, test_m=2000, f=9, T=100, heterogeneity='homogeneous', alpha=1, attack='NS', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=2, nb_classes=10, algo='IPGD', eval_every=10)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1, 'attack': 'NS', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 2, 'eval_every': 10, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/homogeneous/NS/n_20_m_64_f_9_T_100_runs_5_alpha_1
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [108.26904606819153, 107.67781376838684, 107.4329264163971, 107.68912696838379, 107.34227728843689]
results [[[74.25 79.25]
  [79.3  83.15]
  [82.45 84.55]
  [83.3  85.75]
  [83.25 84.5 ]
  [78.2  85.7 ]]

 [[80.85 76.7 ]
  [83.25 82.8 ]
  [84.55 86.05]
  [85.05 87.25]
  [86.05 87.3 ]
  [82.65 83.9 ]]

 [[79.9  84.35]
  [82.1  86.15]
  [83.45 86.8 ]
  [83.95 86.9 ]
  [84.8  86.2 ]
  [82.   84.4 ]]

 [[73.95 79.75]
  [77.55 84.1 ]
  [80.05 85.65]
  [82.65 87.95]
  [82.25 87.45]
  [80.1  85.35]]

 [[76.05 83.2 ]
  [79.8  84.9 ]
  [82.9  85.55]
  [84.25 86.3 ]
  [84.   86.75]
  [81.65 85.8 ]]]
Average accuracies for last run  [79.625 82.35  84.225 85.275 85.375 83.725]
f1 score for last run  [[1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]
 [1. 1.]]
Average accuracies  [78.825 82.31  84.2   85.335 85.255 82.975]
F1 score [0.99951767 0.99975787 1.         1.         1.         1.        ]
