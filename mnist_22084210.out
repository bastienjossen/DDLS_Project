Namespace(n=20, m=32, test_m=2000, f=0, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='36,23,40,42,14,20,34,29,32,24,40,39,33,43,36,24,36,23,40,32')
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_32_f_0_T_100_runs_5_alpha_0.5_I
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [40.00545144081116, 34.88078427314758, 34.84777331352234, 34.97392797470093, 34.79919672012329]
results [[[77.8 ]
  [82.9 ]
  [85.3 ]
  [85.65]
  [83.7 ]
  [62.2 ]]

 [[75.95]
  [84.2 ]
  [86.7 ]
  [87.15]
  [65.05]
  [85.15]]

 [[71.9 ]
  [77.05]
  [80.8 ]
  [82.45]
  [76.5 ]
  [81.6 ]]

 [[75.65]
  [79.95]
  [83.85]
  [80.35]
  [77.05]
  [81.85]]

 [[77.7 ]
  [84.75]
  [80.45]
  [79.8 ]
  [83.3 ]
  [45.45]]]
Average accuracies for last run  [77.7  84.75 80.45 79.8  83.3  45.45]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [75.8  81.77 83.42 83.08 77.12 71.25]
F1 score [1. 1. 1. 1. 1. 1.]
