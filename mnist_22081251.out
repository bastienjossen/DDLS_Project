Namespace(n=20, m=32, test_m=2000, f=0, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='36,23,40,42,14,20,34,29,32,24,40,39,33,43,36,24,36,23,40,32')
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_32_f_0_T_100_runs_5_alpha_0.5_x
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [189.69592690467834, 182.10645818710327, 158.7245409488678, 134.38365578651428, 134.67785239219666]
results [[[77.8 ]
  [82.85]
  [85.45]
  [87.25]
  [83.7 ]
  [59.35]]

 [[76.05]
  [84.05]
  [86.8 ]
  [87.5 ]
  [55.2 ]
  [85.05]]

 [[71.7 ]
  [77.05]
  [80.75]
  [82.35]
  [73.35]
  [82.05]]

 [[75.75]
  [80.05]
  [83.85]
  [80.85]
  [76.85]
  [83.75]]

 [[77.85]
  [84.5 ]
  [69.  ]
  [79.75]
  [83.35]
  [47.45]]]
Average accuracies for last run  [77.85 84.5  69.   79.75 83.35 47.45]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [75.83 81.7  81.17 83.54 74.49 71.53]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=3, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='36,23,40,42,14,20,33,29,32,24,40,39,33,43,36,24,36')
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_32_f_3_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [163.8998579978943, 159.8340871334076, 166.25499844551086, 166.26987147331238, 157.3908200263977]
results [[[79.35]
  [86.95]
  [89.  ]
  [79.15]
  [65.05]
  [82.75]]

 [[75.  ]
  [78.8 ]
  [80.05]
  [64.1 ]
  [70.25]
  [75.35]]

 [[78.95]
  [84.55]
  [85.65]
  [80.95]
  [73.8 ]
  [73.5 ]]

 [[75.05]
  [72.55]
  [78.3 ]
  [81.2 ]
  [82.15]
  [72.45]]

 [[69.9 ]
  [75.4 ]
  [78.35]
  [73.05]
  [66.35]
  [49.15]]]
Average accuracies for last run  [69.9  75.4  78.35 73.05 66.35 49.15]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [75.65 79.65 82.27 75.69 71.52 70.64]
F1 score [1.         0.99911111 1.         1.         1.         1.        ]
Namespace(n=20, m=32, test_m=2000, f=6, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='36,22,40,42,13,19,33,29,32,24,41,40,33,44')
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_32_f_6_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [149.35188627243042, 147.92740607261658, 147.82338213920593, 147.8189001083374, 147.69589805603027]
results [[[77.85]
  [85.4 ]
  [87.15]
  [86.5 ]
  [82.95]
  [65.75]]

 [[78.15]
  [81.7 ]
  [72.15]
  [82.6 ]
  [74.85]
  [41.15]]

 [[78.5 ]
  [83.45]
  [82.  ]
  [80.85]
  [76.55]
  [47.6 ]]

 [[73.35]
  [78.  ]
  [80.  ]
  [80.8 ]
  [44.2 ]
  [59.55]]

 [[74.2 ]
  [75.6 ]
  [75.7 ]
  [79.9 ]
  [75.3 ]
  [31.95]]]
Average accuracies for last run  [74.2  75.6  75.7  79.9  75.3  31.95]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [76.41 80.83 79.4  82.13 70.77 49.2 ]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=9, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='38,24,42,44,14,20,36,31,34,26,43')
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_32_f_9_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [125.98866248130798, 125.76014471054077, 125.15638303756714, 124.76330494880676, 124.83730983734131]
results [[[75.9 ]
  [79.2 ]
  [80.7 ]
  [65.9 ]
  [73.75]
  [ 6.3 ]]

 [[70.15]
  [77.9 ]
  [80.45]
  [72.35]
  [66.55]
  [57.2 ]]

 [[73.7 ]
  [75.2 ]
  [77.15]
  [70.25]
  [68.1 ]
  [ 3.1 ]]

 [[75.8 ]
  [80.  ]
  [80.2 ]
  [79.35]
  [72.  ]
  [ 2.25]]

 [[76.85]
  [78.3 ]
  [80.05]
  [76.7 ]
  [67.8 ]
  [ 2.5 ]]]
Average accuracies for last run  [76.85 78.3  80.05 76.7  67.8   2.5 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [0.]
 [0.]]
Average accuracies  [74.48 78.12 79.71 72.91 69.64 14.27]
F1 score [0.8 0.8 0.8 1.  0.6 0.2]
Namespace(n=20, m=64, test_m=2000, f=0, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='70,43,78,83,27,39,67,59,65,48,82,80,66,87,74,48,72,46,82,64')
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_64_f_0_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [271.43077325820923, 269.41678166389465, 227.38664031028748, 227.34171605110168, 227.92792439460754]
results [[[82.6 ]
  [74.2 ]
  [87.25]
  [84.75]
  [84.45]
  [42.35]]

 [[83.35]
  [88.3 ]
  [90.  ]
  [83.45]
  [78.85]
  [63.35]]

 [[78.45]
  [81.45]
  [78.8 ]
  [83.3 ]
  [72.25]
  [81.1 ]]

 [[85.05]
  [87.95]
  [88.3 ]
  [84.8 ]
  [85.25]
  [81.4 ]]

 [[82.15]
  [86.3 ]
  [87.15]
  [65.05]
  [62.3 ]
  [86.2 ]]]
Average accuracies for last run  [82.15 86.3  87.15 65.05 62.3  86.2 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [82.32 83.64 86.3  80.27 76.62 70.88]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=3, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='70,43,79,83,27,39,67,58,65,48,82,80,66,87,74,48,72')
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_64_f_3_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [208.5689561367035, 207.76198959350586, 208.21407270431519, 207.90137362480164, 208.22097849845886]
results [[[84.2 ]
  [81.25]
  [79.  ]
  [83.6 ]
  [83.7 ]
  [41.45]]

 [[74.3 ]
  [79.  ]
  [80.2 ]
  [58.9 ]
  [80.45]
  [68.35]]

 [[82.45]
  [82.9 ]
  [83.8 ]
  [83.05]
  [81.3 ]
  [83.95]]

 [[81.75]
  [84.15]
  [83.45]
  [83.5 ]
  [48.1 ]
  [81.6 ]]

 [[80.  ]
  [82.95]
  [85.6 ]
  [78.75]
  [68.85]
  [28.3 ]]]
Average accuracies for last run  [80.   82.95 85.6  78.75 68.85 28.3 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [80.54 82.05 82.41 77.56 72.48 60.73]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=6, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='70,44,79,83,27,39,67,59,65,48,82,80,66,87')
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_64_f_6_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [195.89656853675842, 185.02900314331055, 185.0963900089264, 184.97884035110474, 185.0060329437256]
results [[[84.9 ]
  [82.35]
  [81.7 ]
  [78.45]
  [58.35]
  [54.75]]

 [[59.8 ]
  [85.9 ]
  [80.15]
  [77.1 ]
  [68.2 ]
  [56.25]]

 [[77.15]
  [80.8 ]
  [78.95]
  [78.4 ]
  [39.15]
  [24.6 ]]

 [[84.4 ]
  [85.4 ]
  [82.85]
  [49.6 ]
  [32.1 ]
  [42.1 ]]

 [[76.8 ]
  [80.1 ]
  [81.6 ]
  [65.85]
  [53.2 ]
  [33.05]]]
Average accuracies for last run  [76.8  80.1  81.6  65.85 53.2  33.05]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [76.61 82.91 81.05 69.88 50.2  42.15]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=9, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGDW', eval_every=1, m_list='74,47,84,88,29,42,71,62,69,51,87')
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGDW'}
Created new directory  ./experiments_distribution/mnist/SF/dirichlet_mnist/n_20_m_64_f_9_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [169.11012053489685, 204.1095836162567, 202.78536558151245, 164.49939942359924, 163.79871940612793]
results [[[81.55]
  [83.45]
  [84.55]
  [73.05]
  [75.5 ]
  [56.1 ]]

 [[81.4 ]
  [81.55]
  [81.35]
  [76.7 ]
  [74.1 ]
  [ 3.1 ]]

 [[79.55]
  [77.25]
  [80.9 ]
  [78.95]
  [72.25]
  [55.45]]

 [[84.15]
  [85.45]
  [78.9 ]
  [79.3 ]
  [71.7 ]
  [50.9 ]]

 [[82.35]
  [83.7 ]
  [81.25]
  [74.8 ]
  [71.4 ]
  [42.4 ]]]
Average accuracies for last run  [82.35 83.7  81.25 74.8  71.4  42.4 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [0.]]
Average accuracies  [81.8  82.28 81.39 76.56 72.99 41.59]
F1 score [1. 1. 1. 1. 1. 0.]
