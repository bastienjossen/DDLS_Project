Namespace(n=20, m=32, test_m=2000, f=0, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='NS', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'NS', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/NS/dirichlet_mnist/n_20_m_32_f_0_T_100_runs_5_alpha_0.5_m
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [45.3082709312439, 39.79313898086548, 39.86839056015015, 39.8035101890564, 39.896160364151]
results [[[73.7 ]
  [84.55]
  [88.3 ]
  [88.45]
  [87.6 ]
  [86.05]]

 [[77.65]
  [74.15]
  [83.8 ]
  [83.35]
  [76.35]
  [45.15]]

 [[66.95]
  [74.  ]
  [81.55]
  [72.6 ]
  [82.15]
  [68.05]]

 [[71.3 ]
  [65.25]
  [85.85]
  [70.7 ]
  [78.05]
  [83.95]]

 [[70.4 ]
  [77.25]
  [80.45]
  [80.3 ]
  [79.35]
  [84.35]]]
Average accuracies for last run  [70.4  77.25 80.45 80.3  79.35 84.35]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [72.   75.04 83.99 79.08 80.7  73.51]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=3, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='NS', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'NS', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/NS/dirichlet_mnist/n_20_m_32_f_3_T_100_runs_5_alpha_0.5_S
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [36.39095115661621, 35.942384004592896, 35.97189545631409, 35.91678786277771, 35.98849940299988]
results [[[73.8 ]
  [82.9 ]
  [86.25]
  [89.05]
  [83.35]
  [86.45]]

 [[72.95]
  [76.35]
  [79.5 ]
  [83.7 ]
  [65.  ]
  [59.2 ]]

 [[74.95]
  [71.05]
  [79.45]
  [80.85]
  [80.7 ]
  [43.65]]

 [[78.3 ]
  [83.25]
  [71.35]
  [80.4 ]
  [78.65]
  [37.1 ]]

 [[74.15]
  [66.75]
  [80.3 ]
  [80.95]
  [58.  ]
  [72.65]]]
Average accuracies for last run  [74.15 66.75 80.3  80.95 58.   72.65]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [74.83 76.06 79.37 82.99 73.14 59.81]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=6, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='NS', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'NS', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/NS/dirichlet_mnist/n_20_m_32_f_6_T_100_runs_5_alpha_0.5_q
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [32.395650148391724, 32.03925037384033, 32.03754687309265, 31.999327898025513, 32.09682512283325]
results [[[73.65]
  [80.1 ]
  [83.25]
  [84.8 ]
  [72.45]
  [59.85]]

 [[69.05]
  [74.3 ]
  [74.6 ]
  [73.25]
  [76.75]
  [41.  ]]

 [[72.2 ]
  [75.05]
  [75.65]
  [72.2 ]
  [77.25]
  [42.65]]

 [[77.95]
  [84.85]
  [84.25]
  [80.65]
  [77.25]
  [31.65]]

 [[73.25]
  [81.  ]
  [79.65]
  [84.85]
  [83.05]
  [64.25]]]
Average accuracies for last run  [73.25 81.   79.65 84.85 83.05 64.25]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [73.22 79.06 79.48 79.15 77.35 47.88]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=9, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='NS', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'NS', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/NS/dirichlet_mnist/n_20_m_32_f_9_T_100_runs_5_alpha_0.5_I
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [27.808643341064453, 27.510728120803833, 27.64662218093872, 27.624478578567505, 27.56879949569702]
results [[[73.85]
  [75.7 ]
  [75.95]
  [73.8 ]
  [61.2 ]
  [ 8.85]]

 [[72.35]
  [73.85]
  [73.2 ]
  [65.  ]
  [57.7 ]
  [ 2.9 ]]

 [[72.65]
  [74.1 ]
  [73.35]
  [70.6 ]
  [60.05]
  [ 2.35]]

 [[69.8 ]
  [69.9 ]
  [70.35]
  [68.4 ]
  [58.7 ]
  [ 2.55]]

 [[71.6 ]
  [74.8 ]
  [77.2 ]
  [63.95]
  [57.65]
  [12.75]]]
Average accuracies for last run  [71.6  74.8  77.2  63.95 57.65 12.75]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [0.]
 [0.]]
Average accuracies  [72.05 73.67 74.01 68.35 59.06  5.88]
F1 score [1. 1. 1. 1. 0. 0.]
Namespace(n=20, m=64, test_m=2000, f=0, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='NS', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'NS', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/NS/dirichlet_mnist/n_20_m_64_f_0_T_100_runs_5_alpha_0.5_b
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [50.170881509780884, 49.783302545547485, 51.28986215591431, 49.96192026138306, 49.856730699539185]
results [[[72.9 ]
  [81.7 ]
  [88.2 ]
  [86.7 ]
  [88.75]
  [86.95]]

 [[73.75]
  [77.6 ]
  [54.65]
  [84.1 ]
  [67.1 ]
  [83.9 ]]

 [[74.35]
  [79.65]
  [81.5 ]
  [55.9 ]
  [85.25]
  [80.3 ]]

 [[79.55]
  [84.5 ]
  [87.55]
  [87.85]
  [79.  ]
  [81.75]]

 [[82.35]
  [87.55]
  [88.7 ]
  [89.  ]
  [63.65]
  [57.45]]]
Average accuracies for last run  [82.35 87.55 88.7  89.   63.65 57.45]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [76.58 82.2  80.12 80.71 76.75 78.07]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=3, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='NS', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'NS', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/NS/dirichlet_mnist/n_20_m_64_f_3_T_100_runs_5_alpha_0.5_a
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [46.38073110580444, 46.01276445388794, 46.01303291320801, 45.84030866622925, 45.953243017196655]
results [[[72.8 ]
  [85.4 ]
  [86.3 ]
  [83.6 ]
  [47.4 ]
  [79.15]]

 [[80.8 ]
  [85.55]
  [85.25]
  [72.9 ]
  [76.5 ]
  [64.  ]]

 [[76.25]
  [81.2 ]
  [61.55]
  [34.75]
  [83.65]
  [64.45]]

 [[82.25]
  [87.05]
  [82.45]
  [76.1 ]
  [59.6 ]
  [81.35]]

 [[75.4 ]
  [84.9 ]
  [77.05]
  [66.85]
  [55.15]
  [84.3 ]]]
Average accuracies for last run  [75.4  84.9  77.05 66.85 55.15 84.3 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [77.5  84.82 78.52 66.84 64.46 74.65]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=6, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='NS', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'NS', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/NS/dirichlet_mnist/n_20_m_64_f_6_T_100_runs_5_alpha_0.5_B
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [40.82115364074707, 40.35175609588623, 40.518601417541504, 40.35220551490784, 40.396119356155396]
results [[[75.55]
  [81.15]
  [83.05]
  [82.5 ]
  [83.85]
  [38.4 ]]

 [[77.45]
  [82.5 ]
  [84.3 ]
  [84.2 ]
  [83.2 ]
  [66.  ]]

 [[81.  ]
  [82.35]
  [72.75]
  [65.65]
  [71.55]
  [33.6 ]]

 [[78.05]
  [79.95]
  [79.05]
  [79.45]
  [82.5 ]
  [74.8 ]]

 [[76.65]
  [81.05]
  [78.  ]
  [81.95]
  [81.65]
  [40.05]]]
Average accuracies for last run  [76.65 81.05 78.   81.95 81.65 40.05]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [77.74 81.4  79.43 78.75 80.55 50.57]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=9, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='NS', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'NS', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/NS/dirichlet_mnist/n_20_m_64_f_9_T_100_runs_5_alpha_0.5_F
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [34.36743927001953, 34.123878479003906, 34.21433472633362, 34.129897356033325, 34.21313738822937]
results [[[73.15]
  [80.45]
  [67.3 ]
  [61.2 ]
  [63.4 ]
  [12.25]]

 [[75.4 ]
  [76.65]
  [74.4 ]
  [71.85]
  [57.95]
  [ 9.85]]

 [[64.45]
  [83.1 ]
  [82.95]
  [74.85]
  [57.35]
  [17.25]]

 [[78.35]
  [78.2 ]
  [76.65]
  [75.1 ]
  [66.2 ]
  [ 2.6 ]]

 [[81.75]
  [80.3 ]
  [73.9 ]
  [69.55]
  [62.75]
  [63.75]]]
Average accuracies for last run  [81.75 80.3  73.9  69.55 62.75 63.75]
f1 score for last run  [[1.        ]
 [1.        ]
 [0.99999999]
 [0.        ]
 [0.        ]
 [1.        ]]
Average accuracies  [74.62 79.74 75.04 70.51 61.53 21.14]
F1 score [1.  1.  1.  0.6 0.2 0.4]
