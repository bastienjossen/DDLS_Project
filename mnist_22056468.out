Namespace(n=20, m=32, test_m=2000, f=0, T=100, heterogeneity='homogeneous', alpha=1000.0, attack='GR', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1000.0, 'attack': 'GR', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/GR/homogeneous/n_20_m_32_f_0_T_100_runs_5_alpha_1000.0
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [57.90225577354431, 57.819109201431274, 57.669809103012085, 57.72301888465881, 57.62059044837952]
results [[[58.4 ]
  [86.05]
  [88.  ]
  [89.2 ]
  [89.85]
  [89.9 ]]

 [[64.65]
  [84.7 ]
  [88.65]
  [89.7 ]
  [90.75]
  [91.65]]

 [[61.5 ]
  [85.8 ]
  [89.25]
  [90.15]
  [91.5 ]
  [91.75]]

 [[60.5 ]
  [85.  ]
  [87.65]
  [80.  ]
  [89.6 ]
  [89.95]]

 [[57.45]
  [86.45]
  [88.7 ]
  [89.95]
  [90.25]
  [90.6 ]]]
Average accuracies for last run  [57.45 86.45 88.7  89.95 90.25 90.6 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [60.5  85.6  88.45 87.8  90.39 90.77]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=3, T=100, heterogeneity='homogeneous', alpha=1000.0, attack='GR', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1000.0, 'attack': 'GR', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/GR/homogeneous/n_20_m_32_f_3_T_100_runs_5_alpha_1000.0
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [52.959901332855225, 52.8412446975708, 52.7629656791687, 52.67452549934387, 52.669023275375366]
results [[[58.4 ]
  [84.05]
  [86.25]
  [87.35]
  [87.3 ]
  [87.4 ]]

 [[64.3 ]
  [82.  ]
  [85.85]
  [87.35]
  [87.95]
  [88.15]]

 [[61.5 ]
  [83.  ]
  [85.8 ]
  [87.  ]
  [87.65]
  [88.1 ]]

 [[60.5 ]
  [82.2 ]
  [85.6 ]
  [86.85]
  [86.75]
  [87.05]]

 [[57.55]
  [84.7 ]
  [87.  ]
  [88.1 ]
  [88.75]
  [88.55]]]
Average accuracies for last run  [57.55 84.7  87.   88.1  88.75 88.55]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [60.45 83.19 86.1  87.33 87.68 87.85]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=6, T=100, heterogeneity='homogeneous', alpha=1000.0, attack='GR', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1000.0, 'attack': 'GR', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/GR/homogeneous/n_20_m_32_f_6_T_100_runs_5_alpha_1000.0
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [47.0542471408844, 46.80458879470825, 46.86643171310425, 46.82697343826294, 46.93344783782959]
results [[[57.75]
  [78.55]
  [82.55]
  [82.35]
  [83.3 ]
  [81.2 ]]

 [[64.3 ]
  [76.  ]
  [80.  ]
  [81.4 ]
  [83.05]
  [82.8 ]]

 [[61.4 ]
  [76.85]
  [81.45]
  [82.9 ]
  [83.75]
  [79.15]]

 [[60.65]
  [78.8 ]
  [80.35]
  [80.45]
  [82.  ]
  [80.6 ]]

 [[57.5 ]
  [78.4 ]
  [82.85]
  [84.7 ]
  [85.1 ]
  [83.5 ]]]
Average accuracies for last run  [57.5  78.4  82.85 84.7  85.1  83.5 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [60.32 77.72 81.44 82.36 83.44 81.45]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=9, T=100, heterogeneity='homogeneous', alpha=1000.0, attack='GR', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1000.0, 'attack': 'GR', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/GR/homogeneous/n_20_m_32_f_9_T_100_runs_5_alpha_1000.0
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [41.69988989830017, 41.538586378097534, 41.49876856803894, 41.535903215408325, 41.49403953552246]
results [[[58.45]
  [65.5 ]
  [65.95]
  [66.2 ]
  [59.05]
  [20.25]]

 [[64.5 ]
  [62.2 ]
  [63.35]
  [59.35]
  [60.05]
  [25.1 ]]

 [[61.45]
  [57.65]
  [57.1 ]
  [56.9 ]
  [55.65]
  [31.9 ]]

 [[60.65]
  [62.05]
  [63.65]
  [61.15]
  [60.9 ]
  [56.55]]

 [[57.85]
  [61.4 ]
  [62.  ]
  [64.55]
  [65.75]
  [40.85]]]
Average accuracies for last run  [57.85 61.4  62.   64.55 65.75 40.85]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [0.]]
Average accuracies  [60.58 61.76 62.41 61.63 60.28 34.93]
F1 score [1.         0.99947781 0.99947781 1.         1.         0.39578767]
Namespace(n=20, m=64, test_m=2000, f=0, T=100, heterogeneity='homogeneous', alpha=1000.0, attack='GR', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1000.0, 'attack': 'GR', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/GR/homogeneous/n_20_m_64_f_0_T_100_runs_5_alpha_1000.0
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [80.96422338485718, 80.94085550308228, 80.78863763809204, 80.93974232673645, 80.69059014320374]
results [[[73.6 ]
  [87.95]
  [90.75]
  [91.4 ]
  [88.8 ]
  [91.85]]

 [[81.35]
  [88.95]
  [91.  ]
  [91.75]
  [92.45]
  [92.4 ]]

 [[80.15]
  [89.25]
  [91.1 ]
  [91.85]
  [92.  ]
  [91.8 ]]

 [[74.8 ]
  [88.1 ]
  [90.35]
  [91.35]
  [91.9 ]
  [91.55]]

 [[75.9 ]
  [87.15]
  [89.15]
  [91.05]
  [92.05]
  [92.  ]]]
Average accuracies for last run  [75.9  87.15 89.15 91.05 92.05 92.  ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [77.16 88.28 90.47 91.48 91.44 91.92]
F1 score [0.99904022 1.         1.         1.         1.         1.        ]
Namespace(n=20, m=64, test_m=2000, f=3, T=100, heterogeneity='homogeneous', alpha=1000.0, attack='GR', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1000.0, 'attack': 'GR', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/GR/homogeneous/n_20_m_64_f_3_T_100_runs_5_alpha_1000.0
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [72.01586842536926, 71.8923134803772, 71.77939772605896, 71.74406814575195, 71.77191853523254]
results [[[73.95]
  [85.95]
  [88.8 ]
  [89.5 ]
  [90.  ]
  [88.35]]

 [[80.95]
  [86.95]
  [89.1 ]
  [89.7 ]
  [90.4 ]
  [91.05]]

 [[80.4 ]
  [87.5 ]
  [89.35]
  [90.05]
  [90.35]
  [90.35]]

 [[73.7 ]
  [86.25]
  [88.7 ]
  [89.7 ]
  [89.85]
  [90.2 ]]

 [[75.95]
  [86.  ]
  [87.9 ]
  [89.2 ]
  [90.2 ]
  [89.5 ]]]
Average accuracies for last run  [75.95 86.   87.9  89.2  90.2  89.5 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [76.99 86.53 88.77 89.63 90.16 89.89]
F1 score [0.99903534 1.         1.         1.         1.         1.        ]
Namespace(n=20, m=64, test_m=2000, f=6, T=100, heterogeneity='homogeneous', alpha=1000.0, attack='GR', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1000.0, 'attack': 'GR', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/GR/homogeneous/n_20_m_64_f_6_T_100_runs_5_alpha_1000.0
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [63.393848180770874, 63.20195913314819, 63.42065072059631, 63.32528495788574, 63.11679816246033]
results [[[74.  ]
  [82.6 ]
  [85.55]
  [86.3 ]
  [86.  ]
  [83.55]]

 [[81.45]
  [84.65]
  [85.9 ]
  [86.4 ]
  [87.85]
  [88.25]]

 [[80.05]
  [84.2 ]
  [85.8 ]
  [85.6 ]
  [86.6 ]
  [83.9 ]]

 [[73.75]
  [81.7 ]
  [84.75]
  [86.45]
  [86.9 ]
  [87.25]]

 [[75.9 ]
  [83.1 ]
  [85.65]
  [86.9 ]
  [87.35]
  [86.7 ]]]
Average accuracies for last run  [75.9  83.1  85.65 86.9  87.35 86.7 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [77.03 83.25 85.53 86.33 86.94 85.93]
F1 score [0.99950372 0.99951807 1.         1.         1.         1.        ]
Namespace(n=20, m=64, test_m=2000, f=9, T=100, heterogeneity='homogeneous', alpha=1000.0, attack='GR', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1000.0, 'attack': 'GR', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/GR/homogeneous/n_20_m_64_f_9_T_100_runs_5_alpha_1000.0
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [53.62880182266235, 53.49568152427673, 53.37822365760803, 53.65871500968933, 53.442649841308594]
results [[[73.65]
  [76.4 ]
  [76.45]
  [78.4 ]
  [78.1 ]
  [68.9 ]]

 [[81.2 ]
  [78.35]
  [78.7 ]
  [76.45]
  [75.3 ]
  [74.15]]

 [[79.9 ]
  [79.4 ]
  [78.3 ]
  [76.05]
  [81.2 ]
  [73.05]]

 [[73.45]
  [75.5 ]
  [73.4 ]
  [73.1 ]
  [76.95]
  [64.05]]

 [[76.  ]
  [78.65]
  [80.15]
  [83.55]
  [81.65]
  [75.75]]]
Average accuracies for last run  [76.   78.65 80.15 83.55 81.65 75.75]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [76.84 77.66 77.4  77.51 78.64 71.18]
F1 score [0.99903534 0.99903779 0.99903505 0.9990424  0.99951574 1.        ]
