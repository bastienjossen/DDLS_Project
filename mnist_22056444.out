Namespace(n=20, m=32, test_m=2000, f=0, T=100, heterogeneity='homogeneous', alpha=1000.0, attack='auto_FOE', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1000.0, 'attack': 'auto_FOE', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/auto_FOE/homogeneous/n_20_m_32_f_0_T_100_runs_5_alpha_1000.0
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [57.829384088516235, 57.740549087524414, 57.64655923843384, 57.59011507034302, 57.61011219024658]
results [[[58.3 ]
  [86.25]
  [88.1 ]
  [89.25]
  [89.85]
  [89.9 ]]

 [[64.3 ]
  [85.3 ]
  [88.8 ]
  [89.65]
  [90.7 ]
  [91.4 ]]

 [[61.65]
  [86.15]
  [89.2 ]
  [90.65]
  [91.1 ]
  [91.35]]

 [[60.6 ]
  [84.8 ]
  [87.45]
  [89.  ]
  [89.55]
  [90.1 ]]

 [[57.65]
  [86.5 ]
  [88.9 ]
  [89.7 ]
  [90.75]
  [90.8 ]]]
Average accuracies for last run  [57.65 86.5  88.9  89.7  90.75 90.8 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [60.5  85.8  88.49 89.65 90.39 90.71]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=3, T=100, heterogeneity='homogeneous', alpha=1000.0, attack='auto_FOE', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1000.0, 'attack': 'auto_FOE', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/auto_FOE/homogeneous/n_20_m_32_f_3_T_100_runs_5_alpha_1000.0
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [141.37445640563965, 141.25202465057373, 141.2197780609131, 141.0459041595459, 140.9255063533783]
results [[[58.3 ]
  [83.45]
  [86.2 ]
  [87.15]
  [87.35]
  [87.3 ]]

 [[64.5 ]
  [81.85]
  [85.8 ]
  [87.4 ]
  [88.2 ]
  [88.3 ]]

 [[61.65]
  [82.85]
  [85.7 ]
  [87.  ]
  [87.35]
  [87.05]]

 [[60.6 ]
  [82.25]
  [85.35]
  [86.95]
  [86.75]
  [87.45]]

 [[57.6 ]
  [84.5 ]
  [86.9 ]
  [87.75]
  [88.85]
  [87.8 ]]]
Average accuracies for last run  [57.6  84.5  86.9  87.75 88.85 87.8 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [60.53 82.98 85.99 87.25 87.7  87.58]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=6, T=100, heterogeneity='homogeneous', alpha=1000.0, attack='auto_FOE', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1000.0, 'attack': 'auto_FOE', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/auto_FOE/homogeneous/n_20_m_32_f_6_T_100_runs_5_alpha_1000.0
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [125.53590226173401, 135.19693779945374, 144.96239757537842, 145.36403226852417, 135.2699601650238]
results [[[57.75]
  [80.  ]
  [82.35]
  [83.05]
  [82.6 ]
  [81.25]]

 [[64.35]
  [75.95]
  [79.3 ]
  [81.05]
  [81.9 ]
  [83.8 ]]

 [[61.45]
  [76.8 ]
  [80.8 ]
  [82.65]
  [82.1 ]
  [78.3 ]]

 [[60.55]
  [77.8 ]
  [79.95]
  [81.55]
  [81.3 ]
  [82.2 ]]

 [[57.75]
  [78.3 ]
  [81.95]
  [84.45]
  [84.85]
  [82.15]]]
Average accuracies for last run  [57.75 78.3  81.95 84.45 84.85 82.15]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [60.37 77.77 80.87 82.55 82.55 81.54]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=9, T=100, heterogeneity='homogeneous', alpha=1000.0, attack='auto_FOE', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1000.0, 'attack': 'auto_FOE', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/auto_FOE/homogeneous/n_20_m_32_f_9_T_100_runs_5_alpha_1000.0
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [110.25498104095459, 110.02391147613525, 110.03428244590759, 110.03088712692261, 110.27056527137756]
results [[[58.35]
  [65.35]
  [65.95]
  [65.15]
  [58.  ]
  [25.9 ]]

 [[64.4 ]
  [62.65]
  [63.05]
  [61.25]
  [61.8 ]
  [31.75]]

 [[61.55]
  [57.7 ]
  [56.45]
  [55.15]
  [49.2 ]
  [40.5 ]]

 [[60.65]
  [62.1 ]
  [62.35]
  [61.4 ]
  [59.95]
  [38.7 ]]

 [[57.35]
  [61.1 ]
  [61.5 ]
  [61.75]
  [62.45]
  [40.25]]]
Average accuracies for last run  [57.35 61.1  61.5  61.75 62.45 40.25]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [0.]]
Average accuracies  [60.46 61.78 61.86 60.94 58.28 35.42]
F1 score [1.         0.99946667 0.9994695  0.99945799 1.         0.59950617]
Namespace(n=20, m=64, test_m=2000, f=0, T=100, heterogeneity='homogeneous', alpha=1000.0, attack='auto_FOE', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1000.0, 'attack': 'auto_FOE', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/auto_FOE/homogeneous/n_20_m_64_f_0_T_100_runs_5_alpha_1000.0
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [81.1992506980896, 81.26742672920227, 80.97157502174377, 80.99948716163635, 81.10291695594788]
results [[[73.7 ]
  [88.05]
  [90.65]
  [91.9 ]
  [92.15]
  [91.3 ]]

 [[80.65]
  [89.05]
  [91.05]
  [91.85]
  [92.4 ]
  [92.75]]

 [[80.25]
  [89.15]
  [91.3 ]
  [91.95]
  [86.85]
  [92.05]]

 [[75.3 ]
  [88.1 ]
  [90.15]
  [91.35]
  [91.9 ]
  [86.  ]]

 [[75.85]
  [87.15]
  [89.95]
  [91.  ]
  [91.9 ]
  [92.15]]]
Average accuracies for last run  [75.85 87.15 89.95 91.   91.9  92.15]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [77.15 88.3  90.62 91.61 91.04 90.85]
F1 score [0.99904262 1.         1.         1.         1.         1.        ]
Namespace(n=20, m=64, test_m=2000, f=3, T=100, heterogeneity='homogeneous', alpha=1000.0, attack='auto_FOE', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1000.0, 'attack': 'auto_FOE', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/auto_FOE/homogeneous/n_20_m_64_f_3_T_100_runs_5_alpha_1000.0
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [159.953049659729, 159.72388648986816, 159.47225546836853, 159.47836089134216, 159.43656468391418]
results [[[73.9 ]
  [85.8 ]
  [88.05]
  [89.7 ]
  [89.95]
  [80.5 ]]

 [[80.8 ]
  [87.45]
  [88.55]
  [89.75]
  [90.4 ]
  [90.7 ]]

 [[80.25]
  [87.2 ]
  [89.45]
  [90.15]
  [90.45]
  [87.15]]

 [[73.9 ]
  [86.2 ]
  [88.6 ]
  [90.2 ]
  [89.85]
  [89.85]]

 [[76.05]
  [85.5 ]
  [87.95]
  [89.  ]
  [89.65]
  [89.85]]]
Average accuracies for last run  [76.05 85.5  87.95 89.   89.65 89.85]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [76.98 86.43 88.52 89.76 90.06 87.61]
F1 score [0.99903534 1.         1.         1.         1.         1.        ]
Namespace(n=20, m=64, test_m=2000, f=6, T=100, heterogeneity='homogeneous', alpha=1000.0, attack='auto_FOE', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1000.0, 'attack': 'auto_FOE', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/auto_FOE/homogeneous/n_20_m_64_f_6_T_100_runs_5_alpha_1000.0
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [141.84392833709717, 141.2595772743225, 141.24460911750793, 141.25437474250793, 141.05545258522034]
results [[[73.75]
  [82.45]
  [84.85]
  [85.4 ]
  [86.1 ]
  [83.05]]

 [[81.45]
  [84.1 ]
  [85.75]
  [86.65]
  [87.7 ]
  [87.95]]

 [[80.05]
  [83.8 ]
  [85.4 ]
  [86.1 ]
  [84.8 ]
  [82.65]]

 [[73.95]
  [81.65]
  [84.2 ]
  [86.  ]
  [86.95]
  [86.  ]]

 [[75.85]
  [83.55]
  [86.  ]
  [87.  ]
  [87.1 ]
  [86.25]]]
Average accuracies for last run  [75.85 83.55 86.   87.   87.1  86.25]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [77.01 83.11 85.24 86.23 86.53 85.18]
F1 score [0.99903534 0.99951807 1.         1.         0.99952267 0.99952719]
Namespace(n=20, m=64, test_m=2000, f=9, T=100, heterogeneity='homogeneous', alpha=1000.0, attack='auto_FOE', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'homogeneous', 'alpha': 1000.0, 'attack': 'auto_FOE', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/auto_FOE/homogeneous/n_20_m_64_f_9_T_100_runs_5_alpha_1000.0
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [123.09593224525452, 122.98464775085449, 122.88789558410645, 122.85914015769958, 123.08378887176514]
results [[[73.85]
  [75.45]
  [75.4 ]
  [77.65]
  [77.9 ]
  [38.95]]

 [[81.4 ]
  [78.05]
  [75.15]
  [76.05]
  [69.95]
  [66.95]]

 [[80.45]
  [78.55]
  [77.15]
  [77.5 ]
  [73.25]
  [67.25]]

 [[73.75]
  [75.  ]
  [73.4 ]
  [74.25]
  [67.1 ]
  [37.  ]]

 [[76.1 ]
  [77.8 ]
  [78.5 ]
  [79.65]
  [78.45]
  [42.3 ]]]
Average accuracies for last run  [76.1  77.8  78.5  79.65 78.45 42.3 ]
f1 score for last run  [[1.        ]
 [1.        ]
 [1.        ]
 [1.        ]
 [1.        ]
 [0.99777283]]
Average accuracies  [77.11 76.97 75.92 77.02 73.33 50.49]
F1 score [0.99903286 0.99903779 0.99903286 0.99904735 0.99953162 0.99854446]
