Namespace(n=20, m=32, test_m=2000, f=0, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=2, nb_classes=10, algo='IPGD', eval_every=10)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 2, 'eval_every': 10, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/dirichlet_mnist/SF/n_20_m_32_f_0_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [77.4170298576355, 76.66408944129944, 76.61738204956055, 76.7278642654419, 76.95060849189758]
results [[[73.9  75.4 ]
  [84.6  88.8 ]
  [88.05 87.55]
  [81.55 86.9 ]
  [88.3  86.7 ]
  [83.95 85.75]]

 [[67.15 82.4 ]
  [76.3  89.1 ]
  [80.5  89.35]
  [84.15 88.95]
  [84.1  88.8 ]
  [52.   87.2 ]]

 [[68.1  77.6 ]
  [75.45 86.8 ]
  [77.7  89.2 ]
  [81.35 89.9 ]
  [72.6  90.25]
  [83.45 90.35]]

 [[76.4  84.6 ]
  [33.2  85.3 ]
  [83.75 87.2 ]
  [84.7  88.2 ]
  [84.35 87.25]
  [81.   85.2 ]]

 [[73.65 76.2 ]
  [84.4  88.65]
  [87.9  89.45]
  [86.2  90.45]
  [81.2  90.1 ]
  [61.05 87.5 ]]]
Average accuracies for last run  [74.925 86.525 88.675 88.325 85.65  74.275]
f1 score for last run  [[1.         0.        ]
 [1.         0.99999999]
 [1.         0.99999999]
 [1.         0.99999999]
 [1.         0.99999999]
 [1.         0.99999999]]
Average accuracies  [75.54  79.26  86.065 86.235 85.365 79.745]
F1 score [0.6 1.  1.  1.  1.  1. ]
Namespace(n=20, m=32, test_m=2000, f=3, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=2, nb_classes=10, algo='IPGD', eval_every=10)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 2, 'eval_every': 10, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/dirichlet_mnist/SF/n_20_m_32_f_3_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [72.15943884849548, 71.66077160835266, 71.68003702163696, 71.58224606513977, 71.58734202384949]
results [[[73.75 75.5 ]
  [82.7  88.15]
  [74.9  88.1 ]
  [87.9  88.4 ]
  [65.6  88.1 ]
  [75.4  78.95]]

 [[67.4  83.55]
  [78.35 87.9 ]
  [78.05 88.15]
  [83.3  88.4 ]
  [83.05 87.25]
  [48.2  80.55]]

 [[79.05 77.45]
  [84.8  88.  ]
  [39.3  89.05]
  [85.95 89.1 ]
  [81.4  89.3 ]
  [73.65 85.  ]]

 [[70.85 80.35]
  [79.8  89.  ]
  [81.05 88.95]
  [82.   88.4 ]
  [81.85 81.1 ]
  [81.05 79.7 ]]

 [[77.75 84.25]
  [82.3  89.65]
  [86.15 90.05]
  [81.75 90.5 ]
  [80.15 89.45]
  [68.15 72.55]]]
Average accuracies for last run  [81.    85.975 88.1   86.125 84.8   70.35 ]
f1 score for last run  [[1.         0.        ]
 [1.         0.99999999]
 [1.         0.99999999]
 [1.         0.99999999]
 [1.         0.99999999]
 [1.         0.99999999]]
Average accuracies  [76.99  85.065 80.375 86.57  82.725 74.32 ]
F1 score [0.6 1.  1.  1.  1.  1. ]
Namespace(n=20, m=32, test_m=2000, f=6, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=2, nb_classes=10, algo='IPGD', eval_every=10)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 2, 'eval_every': 10, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/dirichlet_mnist/SF/n_20_m_32_f_6_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [62.753612756729126, 62.429776430130005, 62.59498715400696, 62.27797889709473, 62.47587728500366]
results [[[73.7  75.7 ]
  [79.55 87.2 ]
  [81.7  88.4 ]
  [81.8  89.35]
  [72.75 89.1 ]
  [ 2.4  56.45]]

 [[65.9  80.8 ]
  [70.5  85.75]
  [73.7  86.95]
  [74.6  87.35]
  [67.6  78.5 ]
  [ 8.1  28.6 ]]

 [[74.4  78.85]
  [77.75 88.55]
  [78.2  88.8 ]
  [76.25 89.85]
  [74.05 83.35]
  [ 2.85 30.75]]

 [[70.7  79.95]
  [74.35 87.75]
  [75.3  88.1 ]
  [75.4  88.95]
  [71.1  82.95]
  [ 2.6  51.3 ]]

 [[73.8  81.5 ]
  [76.7  86.8 ]
  [65.85 87.75]
  [72.25 87.7 ]
  [56.4  86.25]
  [12.1  12.15]]]
Average accuracies for last run  [77.65  81.75  76.8   79.975 71.325 12.125]
f1 score for last run  [[1.         0.        ]
 [1.         0.99999999]
 [1.         0.99999999]
 [1.         0.99999999]
 [1.         0.99999999]
 [0.         0.99999999]]
Average accuracies  [75.53  81.49  81.475 82.35  76.205 20.73 ]
F1 score [0.4        0.6        0.99999999 0.99999999 0.9        0.5       ]
Namespace(n=20, m=32, test_m=2000, f=9, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=2, nb_classes=10, algo='IPGD', eval_every=10)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 2, 'eval_every': 10, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/dirichlet_mnist/SF/n_20_m_32_f_9_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [54.21151399612427, 53.477622747421265, 53.554051876068115, 53.45572304725647, 53.48732829093933]
results [[[73.8  75.55]
  [75.3  80.6 ]
  [73.   80.85]
  [70.4  79.85]
  [57.55 68.55]
  [57.3   4.35]]

 [[70.1  77.3 ]
  [71.25 79.3 ]
  [68.6  79.75]
  [65.15 76.45]
  [64.55 70.85]
  [55.7   8.8 ]]

 [[69.4  80.25]
  [71.9  79.1 ]
  [71.3  78.35]
  [66.65 77.3 ]
  [55.25 71.6 ]
  [ 0.4   2.05]]

 [[70.15 78.85]
  [72.   81.5 ]
  [71.95 82.1 ]
  [67.5  84.  ]
  [60.95 77.2 ]
  [58.25  8.6 ]]

 [[77.85 84.  ]
  [78.45 87.5 ]
  [75.25 87.05]
  [68.3  86.8 ]
  [59.7  81.9 ]
  [ 0.65  3.95]]]
Average accuracies for last run  [80.925 82.975 81.15  77.55  70.8    2.3  ]
f1 score for last run  [[1.         0.        ]
 [1.         0.99999998]
 [1.         0.99999999]
 [0.         0.99999995]
 [0.         0.        ]
 [0.         0.99999999]]
Average accuracies  [75.725 77.69  76.82  74.24  66.81  20.005]
F1 score [0.5        0.69999999 0.7        0.49999999 0.3        0.38030769]
Namespace(n=20, m=64, test_m=2000, f=0, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=2, nb_classes=10, algo='IPGD', eval_every=10)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 2, 'eval_every': 10, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/dirichlet_mnist/SF/n_20_m_64_f_0_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [99.56756114959717, 98.87630009651184, 99.0152804851532, 98.88412880897522, 98.83796405792236]
results [[[73.   82.3 ]
  [79.9  89.9 ]
  [79.85 90.4 ]
  [82.1  90.1 ]
  [79.5  90.55]
  [73.65 87.35]]

 [[80.65 83.75]
  [82.9  90.45]
  [83.5  90.3 ]
  [85.55 90.8 ]
  [83.75 89.75]
  [85.05 85.3 ]]

 [[77.7  85.1 ]
  [78.55 90.4 ]
  [70.7  91.45]
  [79.75 92.  ]
  [31.75 91.1 ]
  [86.85 86.95]]

 [[79.25 82.85]
  [83.5  90.9 ]
  [81.95 91.6 ]
  [85.45 91.55]
  [83.55 91.  ]
  [78.55 89.1 ]]

 [[81.95 87.4 ]
  [74.   90.6 ]
  [88.6  90.7 ]
  [88.6  90.75]
  [84.35 65.1 ]
  [69.5  88.4 ]]]
Average accuracies for last run  [84.675 82.3   89.65  89.675 74.725 78.95 ]
f1 score for last run  [[1.         0.        ]
 [1.         0.99999999]
 [1.         0.99999999]
 [1.         0.99999999]
 [1.         0.99999999]
 [1.         0.99999999]]
Average accuracies  [81.395 85.11  85.905 87.665 79.04  83.07 ]
F1 score [0.59999999 1.         1.         1.         1.         1.        ]
Namespace(n=20, m=64, test_m=2000, f=3, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=2, nb_classes=10, algo='IPGD', eval_every=10)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 2, 'eval_every': 10, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/dirichlet_mnist/SF/n_20_m_64_f_3_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [91.3684492111206, 90.90067315101624, 90.82917094230652, 90.81451201438904, 90.83611035346985]
results [[[73.25 82.3 ]
  [83.05 89.9 ]
  [86.1  90.2 ]
  [80.95 90.65]
  [79.   89.75]
  [54.5  86.35]]

 [[78.25 83.1 ]
  [82.75 89.15]
  [83.8  89.3 ]
  [73.5  88.05]
  [83.25 89.15]
  [59.85 83.2 ]]

 [[79.45 88.1 ]
  [80.5  90.8 ]
  [82.7  91.4 ]
  [81.9  91.25]
  [48.7  90.5 ]
  [45.25 82.55]]

 [[80.8  88.  ]
  [82.9  91.4 ]
  [83.6  92.65]
  [85.85 92.3 ]
  [78.35 35.05]
  [57.35 84.25]]

 [[74.7  82.95]
  [56.75 90.15]
  [83.1  86.35]
  [84.15 92.  ]
  [84.9  90.45]
  [83.25 83.05]]]
Average accuracies for last run  [78.825 73.45  84.725 88.075 87.675 83.15 ]
f1 score for last run  [[1.         0.        ]
 [0.         0.99999998]
 [1.         0.99999999]
 [1.         0.99999999]
 [1.         0.99999999]
 [1.         0.99999999]]
Average accuracies  [81.09  83.735 86.92  86.06  76.91  71.96 ]
F1 score [0.7 0.9 1.  1.  1.  1. ]
Namespace(n=20, m=64, test_m=2000, f=6, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=2, nb_classes=10, algo='IPGD', eval_every=10)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 2, 'eval_every': 10, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/dirichlet_mnist/SF/n_20_m_64_f_6_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [76.80112075805664, 76.46610450744629, 76.65125250816345, 76.55442643165588, 76.58168029785156]
results [[[75.55 82.25]
  [70.15 90.05]
  [82.8  90.7 ]
  [80.65 88.75]
  [71.5  82.55]
  [ 2.3  54.35]]

 [[80.25 87.55]
  [80.5  89.45]
  [78.65 90.1 ]
  [79.1  90.9 ]
  [66.9  88.  ]
  [ 3.35 52.15]]

 [[83.55 86.1 ]
  [82.95 90.25]
  [78.75 91.  ]
  [69.35 91.55]
  [70.45 78.25]
  [18.1  29.8 ]]

 [[76.85 86.05]
  [79.   88.95]
  [78.95 89.6 ]
  [76.65 89.35]
  [73.6  86.8 ]
  [ 5.1  26.05]]

 [[81.25 83.3 ]
  [86.35 88.45]
  [86.8  82.4 ]
  [83.2  88.9 ]
  [76.35 73.35]
  [17.75 38.55]]]
Average accuracies for last run  [82.275 87.4   84.6   86.05  74.85  28.15 ]
f1 score for last run  [[1.         0.        ]
 [1.         0.99999999]
 [1.         0.99999999]
 [1.         0.99999999]
 [1.         0.99999999]
 [0.         0.99999999]]
Average accuracies  [82.27  84.61  84.975 83.84  76.775 24.75 ]
F1 score [0.69999999 1.         1.         1.         0.99999999 0.6       ]
Namespace(n=20, m=64, test_m=2000, f=9, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='SF', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=2, nb_classes=10, algo='IPGD', eval_every=10)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'SF', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 2, 'eval_every': 10, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/dirichlet_mnist/SF/n_20_m_64_f_9_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [66.29082226753235, 65.62639093399048, 65.78005337715149, 65.7214617729187, 65.66968750953674]
results [[[7.310e+01 8.230e+01]
  [7.145e+01 8.285e+01]
  [7.235e+01 8.355e+01]
  [6.615e+01 8.125e+01]
  [6.300e+01 7.695e+01]
  [1.245e+01 3.400e+00]]

 [[7.720e+01 8.445e+01]
  [6.565e+01 8.660e+01]
  [7.300e+01 8.670e+01]
  [6.655e+01 8.700e+01]
  [5.605e+01 7.960e+01]
  [8.150e+00 9.400e+00]]

 [[8.400e+01 8.715e+01]
  [8.395e+01 8.755e+01]
  [7.705e+01 8.785e+01]
  [6.350e+01 8.595e+01]
  [5.600e+01 7.830e+01]
  [3.000e+00 5.000e-01]]

 [[6.235e+01 8.360e+01]
  [8.050e+01 8.645e+01]
  [7.270e+01 8.690e+01]
  [6.395e+01 8.560e+01]
  [6.625e+01 7.470e+01]
  [0.000e+00 1.500e+00]]

 [[7.740e+01 8.420e+01]
  [7.360e+01 8.330e+01]
  [6.980e+01 8.230e+01]
  [6.515e+01 8.155e+01]
  [5.705e+01 6.875e+01]
  [5.000e-02 1.400e+00]]]
Average accuracies for last run  [80.8   78.45  76.05  73.35  62.9    0.725]
f1 score for last run  [[1.         0.99999999]
 [0.99999999 0.99999999]
 [0.         0.99999998]
 [0.         0.99999995]
 [0.         0.        ]
 [0.         0.99999999]]
Average accuracies  [79.575 80.19  79.22  74.665 67.665  3.985]
F1 score [0.8        0.9        0.7        0.59999999 0.         0.4       ]
