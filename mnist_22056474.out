Namespace(n=20, m=32, test_m=2000, f=0, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='mimic', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'mimic', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/mimic/dirichlet_mnist/n_20_m_32_f_0_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [247.9228823184967, 239.83517909049988, 247.96134495735168, 249.65472412109375, 251.0009844303131]
results [[[73.65]
  [84.75]
  [87.9 ]
  [88.25]
  [86.9 ]
  [85.1 ]]

 [[77.6 ]
  [80.7 ]
  [72.  ]
  [83.8 ]
  [60.4 ]
  [83.35]]

 [[68.15]
  [59.45]
  [79.3 ]
  [84.05]
  [83.65]
  [75.05]]

 [[71.45]
  [81.  ]
  [85.35]
  [81.6 ]
  [83.2 ]
  [61.6 ]]

 [[70.35]
  [76.6 ]
  [80.3 ]
  [83.3 ]
  [81.15]
  [60.7 ]]]
Average accuracies for last run  [70.35 76.6  80.3  83.3  81.15 60.7 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [72.24 76.5  80.97 84.2  79.06 73.16]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=3, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='mimic', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'mimic', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/mimic/dirichlet_mnist/n_20_m_32_f_3_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [212.06137442588806, 219.9221589565277, 224.0629231929779, 223.2202181816101, 219.41534781455994]
results [[[73.65]
  [82.55]
  [86.7 ]
  [84.6 ]
  [84.1 ]
  [74.2 ]]

 [[72.9 ]
  [66.5 ]
  [76.9 ]
  [65.7 ]
  [77.5 ]
  [65.35]]

 [[74.85]
  [81.5 ]
  [84.4 ]
  [79.65]
  [80.9 ]
  [80.35]]

 [[78.4 ]
  [83.55]
  [84.35]
  [79.25]
  [79.2 ]
  [75.55]]

 [[74.25]
  [78.5 ]
  [79.4 ]
  [68.1 ]
  [58.55]
  [55.5 ]]]
Average accuracies for last run  [74.25 78.5  79.4  68.1  58.55 55.5 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [74.81 78.52 82.35 75.46 76.05 70.19]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=6, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='mimic', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'mimic', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/mimic/dirichlet_mnist/n_20_m_32_f_6_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [200.87693405151367, 194.9452292919159, 194.88701105117798, 192.8117892742157, 195.41277265548706]
results [[[73.8 ]
  [79.7 ]
  [83.35]
  [86.9 ]
  [75.05]
  [44.2 ]]

 [[69.05]
  [74.05]
  [75.2 ]
  [24.  ]
  [80.55]
  [49.05]]

 [[72.2 ]
  [74.95]
  [75.65]
  [73.6 ]
  [67.25]
  [52.9 ]]

 [[77.95]
  [84.25]
  [85.8 ]
  [79.4 ]
  [80.4 ]
  [53.35]]

 [[73.5 ]
  [79.8 ]
  [82.55]
  [86.2 ]
  [86.6 ]
  [81.9 ]]]
Average accuracies for last run  [73.5  79.8  82.55 86.2  86.6  81.9 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [73.3  78.55 80.51 70.02 77.97 56.28]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=9, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='mimic', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'mimic', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/mimic/dirichlet_mnist/n_20_m_32_f_9_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [169.1708333492279, 171.2352168560028, 165.53822922706604, 171.68961715698242, 167.59828352928162]
results [[[73.7 ]
  [74.75]
  [74.9 ]
  [72.25]
  [62.9 ]
  [10.85]]

 [[72.3 ]
  [71.7 ]
  [74.7 ]
  [74.65]
  [68.7 ]
  [58.45]]

 [[72.65]
  [73.  ]
  [71.8 ]
  [64.45]
  [61.5 ]
  [ 7.85]]

 [[69.8 ]
  [70.15]
  [66.4 ]
  [65.55]
  [65.  ]
  [17.6 ]]

 [[71.45]
  [70.35]
  [68.65]
  [59.65]
  [59.6 ]
  [18.5 ]]]
Average accuracies for last run  [71.45 70.35 68.65 59.65 59.6  18.5 ]
f1 score for last run  [[1.        ]
 [1.        ]
 [1.        ]
 [1.        ]
 [0.99999998]
 [0.        ]]
Average accuracies  [71.98 71.99 71.29 67.31 63.54 22.65]
F1 score [1.         1.         1.         0.8        0.59999999 0.4       ]
Namespace(n=20, m=64, test_m=2000, f=0, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='mimic', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'mimic', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/mimic/dirichlet_mnist/n_20_m_64_f_0_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [330.36964440345764, 329.5327076911926, 315.3341839313507, 324.6798691749573, 334.2199034690857]
results [[[76.95]
  [81.3 ]
  [87.7 ]
  [79.7 ]
  [87.3 ]
  [84.05]]

 [[75.65]
  [67.85]
  [76.5 ]
  [42.3 ]
  [79.15]
  [79.9 ]]

 [[73.9 ]
  [79.8 ]
  [82.6 ]
  [72.6 ]
  [80.75]
  [43.3 ]]

 [[82.7 ]
  [85.6 ]
  [86.9 ]
  [87.1 ]
  [87.65]
  [82.65]]

 [[82.4 ]
  [87.5 ]
  [88.15]
  [88.1 ]
  [81.2 ]
  [67.7 ]]]
Average accuracies for last run  [82.4  87.5  88.15 88.1  81.2  67.7 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [78.32 80.41 84.37 73.96 83.21 71.52]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=3, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='mimic', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'mimic', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/mimic/dirichlet_mnist/n_20_m_64_f_3_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [293.9269564151764, 298.101594209671, 268.2616035938263, 293.9204971790314, 291.0133557319641]
results [[[72.8 ]
  [84.8 ]
  [87.8 ]
  [88.45]
  [81.25]
  [77.5 ]]

 [[81.1 ]
  [85.1 ]
  [86.15]
  [84.45]
  [73.2 ]
  [77.65]]

 [[76.05]
  [80.65]
  [81.75]
  [82.35]
  [82.5 ]
  [63.8 ]]

 [[82.45]
  [85.75]
  [77.5 ]
  [80.25]
  [64.1 ]
  [84.05]]

 [[75.15]
  [84.45]
  [82.85]
  [72.8 ]
  [64.6 ]
  [48.7 ]]]
Average accuracies for last run  [75.15 84.45 82.85 72.8  64.6  48.7 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [77.51 84.15 83.21 81.66 73.13 70.34]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=6, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='mimic', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'mimic', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/mimic/dirichlet_mnist/n_20_m_64_f_6_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [260.39869022369385, 250.26672744750977, 258.963871717453, 257.0204920768738, 253.23513174057007]
results [[[75.6 ]
  [83.5 ]
  [82.7 ]
  [76.8 ]
  [82.05]
  [55.95]]

 [[76.7 ]
  [82.25]
  [83.85]
  [76.8 ]
  [74.95]
  [63.6 ]]

 [[81.65]
  [76.85]
  [71.25]
  [79.75]
  [67.95]
  [58.5 ]]

 [[77.95]
  [65.95]
  [77.4 ]
  [80.75]
  [75.5 ]
  [82.7 ]]

 [[76.75]
  [79.8 ]
  [81.55]
  [82.  ]
  [82.85]
  [57.05]]]
Average accuracies for last run  [76.75 79.8  81.55 82.   82.85 57.05]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [77.73 77.67 79.35 79.22 76.66 63.56]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=9, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='mimic', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'mimic', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/mimic/dirichlet_mnist/n_20_m_64_f_9_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [215.33094191551208, 217.38747191429138, 216.5502245426178, 221.4964780807495, 210.13852906227112]
results [[[73.15]
  [73.2 ]
  [68.95]
  [69.15]
  [68.2 ]
  [ 8.3 ]]

 [[75.4 ]
  [75.1 ]
  [74.65]
  [68.15]
  [71.95]
  [15.85]]

 [[83.3 ]
  [72.4 ]
  [81.15]
  [70.35]
  [73.2 ]
  [22.4 ]]

 [[78.3 ]
  [67.85]
  [76.15]
  [75.95]
  [76.05]
  [13.6 ]]

 [[81.9 ]
  [80.2 ]
  [75.35]
  [58.45]
  [67.7 ]
  [18.8 ]]]
Average accuracies for last run  [81.9  80.2  75.35 58.45 67.7  18.8 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [78.41 73.75 75.25 68.41 71.42 15.79]
F1 score [1.         1.         0.99999999 0.8        0.8        1.        ]
