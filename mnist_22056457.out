Namespace(n=20, m=32, test_m=2000, f=0, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='PR', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'PR', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/PR/dirichlet_mnist/n_20_m_32_f_0_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [39.63008403778076, 39.56547284126282, 39.54932117462158, 39.51416063308716, 39.61998891830444]
results [[[73.65]
  [84.55]
  [87.7 ]
  [87.25]
  [88.7 ]
  [82.35]]

 [[77.7 ]
  [83.6 ]
  [73.95]
  [79.2 ]
  [81.6 ]
  [33.55]]

 [[67.9 ]
  [76.5 ]
  [81.65]
  [84.45]
  [80.65]
  [84.2 ]]

 [[71.35]
  [81.1 ]
  [83.15]
  [73.  ]
  [58.25]
  [85.45]]

 [[70.4 ]
  [76.85]
  [80.2 ]
  [82.65]
  [81.25]
  [85.9 ]]]
Average accuracies for last run  [70.4  76.85 80.2  82.65 81.25 85.9 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [72.2  80.52 81.33 81.31 78.09 74.29]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=3, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='PR', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'PR', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/PR/dirichlet_mnist/n_20_m_32_f_3_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [36.205119609832764, 36.05483436584473, 36.063762187957764, 36.009222745895386, 36.08311581611633]
results [[[73.75]
  [82.1 ]
  [87.  ]
  [82.65]
  [85.3 ]
  [48.8 ]]

 [[72.75]
  [76.7 ]
  [79.6 ]
  [83.05]
  [80.2 ]
  [53.  ]]

 [[75.15]
  [82.55]
  [85.25]
  [86.3 ]
  [64.5 ]
  [82.3 ]]

 [[78.4 ]
  [84.  ]
  [84.  ]
  [85.1 ]
  [79.  ]
  [44.1 ]]

 [[74.2 ]
  [78.7 ]
  [80.15]
  [71.65]
  [57.05]
  [65.9 ]]]
Average accuracies for last run  [74.2  78.7  80.15 71.65 57.05 65.9 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [74.85 80.81 83.2  81.75 73.21 58.82]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=6, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='PR', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'PR', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/PR/dirichlet_mnist/n_20_m_32_f_6_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [31.9142484664917, 31.596953868865967, 31.688933849334717, 31.64515447616577, 31.710328102111816]
results [[[73.7 ]
  [80.3 ]
  [83.  ]
  [76.55]
  [75.15]
  [66.8 ]]

 [[68.6 ]
  [74.45]
  [77.  ]
  [20.45]
  [79.55]
  [49.65]]

 [[71.5 ]
  [75.25]
  [72.4 ]
  [76.25]
  [71.2 ]
  [62.4 ]]

 [[77.95]
  [82.1 ]
  [84.2 ]
  [83.7 ]
  [72.8 ]
  [51.85]]

 [[73.4 ]
  [80.5 ]
  [82.2 ]
  [84.9 ]
  [83.5 ]
  [67.9 ]]]
Average accuracies for last run  [73.4 80.5 82.2 84.9 83.5 67.9]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [73.03 78.52 79.76 68.37 76.44 59.72]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=32, test_m=2000, f=9, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='PR', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=32, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 32, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'PR', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 32, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/PR/dirichlet_mnist/n_20_m_32_f_9_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [28.579681396484375, 27.994673252105713, 28.04800820350647, 28.049269437789917, 28.016520500183105]
results [[[73.7 ]
  [76.15]
  [77.75]
  [76.85]
  [70.45]
  [21.85]]

 [[72.3 ]
  [74.2 ]
  [75.4 ]
  [75.9 ]
  [71.25]
  [75.05]]

 [[72.7 ]
  [74.05]
  [75.  ]
  [75.  ]
  [73.  ]
  [37.7 ]]

 [[69.9 ]
  [70.85]
  [67.75]
  [70.4 ]
  [62.05]
  [48.15]]

 [[71.45]
  [75.7 ]
  [78.75]
  [66.05]
  [68.1 ]
  [59.25]]]
Average accuracies for last run  [71.45 75.7  78.75 66.05 68.1  59.25]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [72.01 74.19 74.93 72.84 68.97 48.4 ]
F1 score [1.  1.  1.  1.  0.8 0.6]
Namespace(n=20, m=64, test_m=2000, f=0, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='PR', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 0, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'PR', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/PR/dirichlet_mnist/n_20_m_64_f_0_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [52.35264706611633, 52.268765687942505, 52.25843644142151, 52.21563124656677, 52.295517921447754]
results [[[72.9 ]
  [80.8 ]
  [88.75]
  [82.8 ]
  [87.  ]
  [65.4 ]]

 [[61.3 ]
  [77.95]
  [79.25]
  [81.75]
  [82.05]
  [83.9 ]]

 [[73.9 ]
  [76.7 ]
  [78.25]
  [77.8 ]
  [83.4 ]
  [39.2 ]]

 [[77.35]
  [86.05]
  [84.05]
  [88.45]
  [82.9 ]
  [39.  ]]

 [[35.3 ]
  [87.45]
  [88.15]
  [88.5 ]
  [82.7 ]
  [76.25]]]
Average accuracies for last run  [35.3  87.45 88.15 88.5  82.7  76.25]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [64.15 81.79 83.69 83.86 83.61 60.75]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=3, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='PR', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 3, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'PR', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/PR/dirichlet_mnist/n_20_m_64_f_3_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [46.16122007369995, 45.88200306892395, 45.89017200469971, 45.773199796676636, 45.932647943496704]
results [[[73.2 ]
  [84.8 ]
  [87.15]
  [88.65]
  [81.5 ]
  [65.  ]]

 [[72.55]
  [85.2 ]
  [86.1 ]
  [83.  ]
  [81.05]
  [79.5 ]]

 [[76.6 ]
  [80.9 ]
  [49.9 ]
  [73.  ]
  [85.05]
  [80.3 ]]

 [[82.55]
  [87.85]
  [84.7 ]
  [76.15]
  [57.8 ]
  [77.95]]

 [[75.25]
  [82.15]
  [82.15]
  [71.75]
  [78.95]
  [43.8 ]]]
Average accuracies for last run  [75.25 82.15 82.15 71.75 78.95 43.8 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [76.03 84.18 78.   78.51 76.87 69.31]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=6, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='PR', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 6, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'PR', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/PR/dirichlet_mnist/n_20_m_64_f_6_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [40.05820107460022, 39.73512053489685, 39.8330979347229, 39.76097559928894, 39.865129232406616]
results [[[75.45]
  [79.8 ]
  [83.75]
  [72.8 ]
  [74.6 ]
  [58.9 ]]

 [[76.65]
  [82.9 ]
  [83.6 ]
  [85.1 ]
  [64.9 ]
  [59.5 ]]

 [[81.55]
  [83.  ]
  [83.7 ]
  [74.5 ]
  [58.6 ]
  [58.15]]

 [[77.95]
  [76.9 ]
  [79.55]
  [80.6 ]
  [82.65]
  [75.6 ]]

 [[76.05]
  [81.5 ]
  [81.8 ]
  [82.75]
  [35.05]
  [68.9 ]]]
Average accuracies for last run  [76.05 81.5  81.8  82.75 35.05 68.9 ]
f1 score for last run  [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
Average accuracies  [77.53 80.82 82.48 79.15 63.16 64.21]
F1 score [1. 1. 1. 1. 1. 1.]
Namespace(n=20, m=64, test_m=2000, f=9, T=100, heterogeneity='dirichlet_mnist', alpha=0.5, attack='PR', agg='trmean', nb_run=5, dataset='mnist', model='cnn', lr=0.05, batch_size=64, nb_main_client=1, nb_classes=10, algo='IPGD', eval_every=1)
device: cuda
{'n': 20, 'm': 64, 'test_m': 2000, 'f': 9, 'T': 100, 'heterogeneity': 'dirichlet_mnist', 'alpha': 0.5, 'attack': 'PR', 'agg': 'trmean', 'nb_run': 5, 'dataset': 'mnist', 'model': 'cnn', 'lr': 0.05, 'gamma': 0.2, 'nb_classes': 10, 'optim': 'gd', 'device': device(type='cuda'), 'seed': 0, 'batch_size': 64, 'nb_main_client': 1, 'eval_every': 1, 'algo': 'IPGD'}
Created new directory  ./experiments/mnist/PR/dirichlet_mnist/n_20_m_64_f_9_T_100_runs_5_alpha_0.5
Initial dataloading done
Run  0
Run  1
Run  2
Run  3
Run  4
runtime [34.410890102386475, 34.11686658859253, 34.253450870513916, 34.15549969673157, 34.210148334503174]
results [[[72.95]
  [74.9 ]
  [75.45]
  [72.1 ]
  [70.25]
  [71.3 ]]

 [[75.4 ]
  [76.05]
  [77.25]
  [76.25]
  [69.25]
  [62.05]]

 [[83.15]
  [84.05]
  [81.95]
  [80.95]
  [66.65]
  [61.45]]

 [[77.4 ]
  [78.05]
  [77.3 ]
  [76.15]
  [74.15]
  [63.7 ]]

 [[80.2 ]
  [71.4 ]
  [81.4 ]
  [79.75]
  [65.65]
  [51.15]]]
Average accuracies for last run  [80.2  71.4  81.4  79.75 65.65 51.15]
f1 score for last run  [[1.        ]
 [1.        ]
 [1.        ]
 [0.99999998]
 [0.        ]
 [1.        ]]
Average accuracies  [77.82 76.89 78.67 77.04 69.19 61.93]
F1 score [1.         1.         1.         0.99999999 0.6        1.        ]
